<div class="dashboard-content">
  <div class="dashboard-header">
    <h1>Track</h1>
  </div>

  @let pets = pets$ | async;

  <!-- Feeding Section -->
  <section class="dashboard-section">
    <div class="section-header">
      <h2>Feeding</h2>
    </div>
    <div class="section-content">
        <div class="feeding-summary-list">
          @for (pet of pets; track pet.id) {
            <div class="feeding-summary-item" routerLink="/feedings" [queryParams]="{ petId: pet.id }">
              <div class="pet-name">
                {{ pet.name }} ate today
                <a 
                  routerLink="/feedings"
                  [queryParams]="{ petId: pet.id, openModal: 'true' }" 
                  class="add-feeding-icon" 
                  (click)="$event.stopPropagation()"
                >+</a>
              </div>

              @let summary = pet.id! | petFeedingSummaryToday | async;
              <div class="summary-stats">
                <div class="stat">
                  <span class="stat-label">Total:</span>
                  <span class="stat-value">{{ summary?.totalGrams ?? '...' }}g</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Daily Portion:</span>
                  <span class="stat-value">{{ pet.dailyPortion }}g</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Feedings:</span>
                  <span class="stat-value">{{ summary?.totalFeedings ?? '...' }}</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Average:</span>
                  <span class="stat-value">{{ summary?.averageGramsPerFeeding ?? '...' }}g</span>
                </div>
              </div>
            </div>
          }
        </div>
    </div>
  </section>

  <!-- Pets Section -->
  <section class="dashboard-section" [routerLink]="pets?.length ? '/pets' : '/add-pet'">
    <div class="section-header">
      <h2>My Pets</h2>
    </div>
    <div class="section-content">
      @if (!pets) {
        <p class="loading-text">Loading...</p>
      } @else if (!pets.length) {
        <p class="placeholder-text">Add your pets</p>
      } @else {
        <p class="placeholder-text">{{ pets.length }} pet{{ pets.length > 1 ? 's' : '' }}</p>
      }
    </div>
  </section>
</div>
